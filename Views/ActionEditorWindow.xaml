<Window x:Class="MacroApp.Views.ActionEditorWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="محرر الإجراءات - ماكرو سرعة"
        Height="400" Width="500"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="{StaticResource BackgroundBrush}"
        Icon="../icon.ico">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="إضافة/تعديل إجراء ماكرو"
                   FontSize="18"
                   FontWeight="SemiBold"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,20"
                   Foreground="{StaticResource TextBrush}"/>

        <!-- Content -->
        <StackPanel Grid.Row="1">
            
            <!-- Action Type -->
            <TextBlock Text="نوع الإجراء:"
                       FontSize="14"
                       FontWeight="Medium"
                       Margin="0,0,0,8"
                       Foreground="{StaticResource TextBrush}"/>
            
            <ComboBox x:Name="ActionTypeComboBox"
                      Style="{StaticResource {x:Type ComboBox}}"
                      FontSize="14"
                      Margin="0,0,0,20"
                      SelectionChanged="ActionTypeComboBox_SelectionChanged">
                <ComboBoxItem Content="Mouse Left Down" Tag="MouseLeftDown"/>
                <ComboBoxItem Content="Mouse Left Up" Tag="MouseLeftUp"/>
                <ComboBoxItem Content="Mouse Right Down" Tag="MouseRightDown"/>
                <ComboBoxItem Content="Mouse Right Up" Tag="MouseRightUp"/>
                <ComboBoxItem Content="Mouse Middle Down" Tag="MouseMiddleDown"/>
                <ComboBoxItem Content="Mouse Middle Up" Tag="MouseMiddleUp"/>
                <ComboBoxItem Content="Key Down" Tag="KeyDown"/>
                <ComboBoxItem Content="Key Up" Tag="KeyUp"/>
                <ComboBoxItem Content="Delay" Tag="Delay"/>
            </ComboBox>

            <!-- Key Code (for keyboard actions) -->
            <StackPanel x:Name="KeyCodePanel" Visibility="Collapsed">
                <TextBlock Text="رمز المفتاح:"
                           FontSize="14"
                           FontWeight="Medium"
                           Margin="0,0,0,8"
                           Foreground="{StaticResource TextBrush}"/>
                
                <TextBox x:Name="KeyCodeTextBox"
                         Style="{StaticResource ModernTextBox}"
                         FontSize="14"
                         Margin="0,0,0,20"
                         MaxLength="10"/>
            </StackPanel>

            <!-- Duration -->
            <StackPanel x:Name="DurationPanel">
                <TextBlock Text="مدة الضغط (بالملي ثانية):"
                           FontSize="14"
                           FontWeight="Medium"
                           Margin="0,0,0,8"
                           Foreground="{StaticResource TextBrush}"/>
                
                <TextBox x:Name="DurationTextBox"
                         Style="{StaticResource ModernTextBox}"
                         FontSize="14"
                         Text="1"
                         Margin="0,0,0,20"/>
            </StackPanel>

            <!-- Delay -->
            <StackPanel x:Name="DelayPanel">
                <TextBlock Text="التأخير بعد الإجراء (بالملي ثانية):"
                           FontSize="14"
                           FontWeight="Medium"
                           Margin="0,0,0,8"
                           Foreground="{StaticResource TextBrush}"/>
                
                <TextBox x:Name="DelayTextBox"
                         Style="{StaticResource ModernTextBox}"
                         FontSize="14"
                         Text="0"
                         Margin="0,0,0,20"/>
            </StackPanel>

            <!-- Preview -->
            <Border Background="{StaticResource SurfaceBrush}"
                    BorderBrush="{StaticResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="15"
                    Margin="0,10,0,0">
                <StackPanel>
                    <TextBlock Text="معاينة الإجراء:"
                               FontSize="14"
                               FontWeight="Medium"
                               Margin="0,0,0,8"
                               Foreground="{StaticResource TextBrush}"/>
                    
                    <TextBlock x:Name="PreviewTextBlock"
                               FontSize="12"
                               FontFamily="Consolas"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               TextWrapping="Wrap"/>
                </StackPanel>
            </Border>

        </StackPanel>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Center"
                    Margin="0,20,0,0">
            
            <Button x:Name="SaveButton"
                    Content="حفظ"
                    Style="{StaticResource PrimaryButton}"
                    Padding="30,12"
                    Margin="0,0,15,0"
                    Click="SaveButton_Click"/>
            
            <Button x:Name="CancelButton"
                    Content="إلغاء"
                    Style="{StaticResource SecondaryButton}"
                    Padding="30,12"
                    Click="CancelButton_Click"/>
        </StackPanel>

    </Grid>
</Window>