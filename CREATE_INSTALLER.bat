@echo off
chcp 65001 >nul
echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo โ                    SR3H MACRO v1.0.0                        โ
echo โ                   ุฅูุดุงุก ููู ุงูุชุซุจูุช                         โ
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
echo.

REM ุงูุชุญูู ูู ูุฌูุฏ Inno Setup
set INNO_PATH="C:\Program Files (x86)\Inno Setup 6\ISCC.exe"
if not exist %INNO_PATH% (
    echo โ ุฎุทุฃ: ูู ูุชู ุงูุนุซูุฑ ุนูู Inno Setup!
    echo.
    echo ๐ฅ ุงูุฑุฌุงุก ุชุซุจูุช Inno Setup 6 ูู ุงูุฑุงุจุท ุงูุชุงูู:
    echo    https://jrsoftware.org/isdl.php
    echo.
    echo ๐ ุชุฃูุฏ ูู ุงูุชุซุจูุช ูู ุงููุณุงุฑ ุงูุงูุชุฑุงุถู:
    echo    C:\Program Files (x86)\Inno Setup 6\
    echo.
    pause
    exit /b 1
)

REM ุฅูุดุงุก ูุฌูุฏ ุงูุฅุฎุฑุงุฌ
if not exist "C:\MACRO_SR3H\Setup\Output" (
    mkdir "C:\MACRO_SR3H\Setup\Output"
)

echo ๐จ ุฌุงุฑู ุจูุงุก ุงูุชุทุจูู...
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
dotnet build "C:\MACRO_SR3H\MacroApp.csproj" --configuration Release --verbosity quiet
if %ERRORLEVEL% neq 0 (
    echo โ ุฎุทุฃ ูู ุจูุงุก ุงูุชุทุจูู!
    echo    ุงูุฑุฌุงุก ุงูุชุญูู ูู ุงูุฃุฎุทุงุก ุฃุนูุงู
    pause
    exit /b 1
)
echo โ ุชู ุจูุงุก ุงูุชุทุจูู ุจูุฌุงุญ

echo.
echo ๐ฆ ุฌุงุฑู ุฅูุดุงุก ููู ุงูุชุซุจูุช...
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
%INNO_PATH% "C:\MACRO_SR3H\Setup\SR3H_MACRO_Setup_v1.0.0.iss"

if %ERRORLEVEL% equ 0 (
    echo.
    echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    echo โ                    โ ุชู ุจูุฌุงุญ! โ                          โ
    echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    echo.
    echo ๐ ููู ุงูุชุซุจูุช ุฌุงูุฒ ูู:
    echo    C:\MACRO_SR3H\Setup\Output\SR3H_MACRO_Setup.exe
    echo.
    echo ๐ฏ ุฎุตุงุฆุต ููู ุงูุชุซุจูุช:
    echo    โ ุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ
    echo    โ ุชุญูู ูู .NET 6.0 Runtime
    echo    โ ุงุฎุชุตุงุฑ ุณุทุญ ุงูููุชุจ
    echo    โ ุชุณุฌูู ูู ูุงุฆูุฉ ุงูุจุฑุงูุฌ
    echo    โ ุญูุงูุฉ ุงูุฃููููุงุช ูุงูููุงุฑุฏ
    echo    โ ุฅููุงููุฉ ุฅูุบุงุก ุงูุชุซุจูุช
    echo.
    echo ๐ ูุนูููุงุช ุงูุชุทุจูู:
    echo    ๐ ุงูุงุณู: SR3H MACRO
    echo    ๐ข ุงูุฅุตุฏุงุฑ: 1.0.0
    echo    ๐ข ุงููุงุดุฑ: ููุตุฉ ุณุฑุนุฉ
    echo    ๐ ุงููููุน: www.SR3H.com
    echo    ๐ง ุงูุจุฑูุฏ: 7jgamer.ads@gmail.com
    echo.
    
    REM ุนุฑุถ ุญุฌู ุงูููู
    for %%A in ("C:\MACRO_SR3H\Setup\Output\SR3H_MACRO_Setup.exe") do (
        set /a filesize=%%~zA/1024/1024
        echo ๐พ ุญุฌู ุงูููู: !filesize! MB ุชูุฑูุจุงู
    )
    
    echo.
    echo ๐ ูู ุชุฑูุฏ ูุชุญ ูุฌูุฏ ุงูุฅุฎุฑุงุฌุ (Y/N)
    set /p choice=
    if /i "%choice%"=="Y" (
        explorer "C:\MACRO_SR3H\Setup\Output"
    )
    
) else (
    echo.
    echo โ ุฎุทุฃ ูู ุฅูุดุงุก ููู ุงูุชุซุจูุช!
    echo.
    echo ๐ ุชุญูู ูู:
    echo    โข ูุฌูุฏ ุฌููุน ุงููููุงุช ุงููุทููุจุฉ
    echo    โข ุตูุงุญูุงุช ุงููุชุงุจุฉ ูู ูุฌูุฏ Output
    echo    โข ุตุญุฉ ููู ุงูุณูุฑูุจุช .iss
    echo.
)

echo.
echo โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
pause